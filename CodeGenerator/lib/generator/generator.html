<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>


<script>

    const fuzzySets_input1 = [0, 20, 40, 60, 80];
    const fuzzySets_input2 = [0, 20, 40, 60, 80];
    const fuzzySets_output = [0, 20, 40, 60, 80];
    
    const fuzzyRuleConsequents = [
        0,  10, 20,
        30, 40, 50,
        60, 70, 80];
    
    const num_fuzzySets_input1 = get_numFuzzySets_input1();
    const num_fuzzySets_input2 = get_numFuzzySets_input2();
    const num_fuzzySets_output = get_numFuzzySets_output();
    const num_fuzzyRuleConsequents = get_numFuzzyRuleConsequents();
    
    const name_input1 = `temp`;
    const name_input2 = `humi`;
    const name_output = `hi`;
    
    
    function get_numFuzzySets_input1()
    {
        return fuzzySets_input1.length;
    }
    
    
    function get_numFuzzySets_input2()
    {
        return fuzzySets_input2.length;
    }
    
    
    function get_numFuzzySets_output()
    {
        return fuzzySets_output.length;
    }
    
    
    function get_numFuzzyRuleConsequents()
    {
        return fuzzyRuleConsequents.length;
    }
    
    
    function print_line()
    {
        let str = `<br>`;
        str += `<br><br>`;
        str += `// `;
        for(let i=0; i<50; ++i) {str += `-`;}
        str += `<br><br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_library()
    {
        let str = `<br>`;
        str += `#include &lt;Arduino.h&gt;<br>`;
        str += `#include &lt;Fuzzy.h&gt;<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_macro()
    {
        let str = `<br>`;
        str += `#define INDEX_FUZZY_INPUT1      1<br>`;
        str += `#define INDEX_FUZZY_INPUT2      2<br>`;
        str += `#define INDEX_FUZZY_OUTPUT      1<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_decFncs_createFuzzyInput()
    {
        let str = `<br>`;
        str += `FuzzyInput crt_fuzzyInput1();<br>`;
        str += `FuzzyInput crt_fuzzyInput2();<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_decFncs_createFuzzyOutput()
    {
        let str = `<br>`;
        str += `FuzzyOutput crt_fuzzyOutput();<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_decFncs_createAntecedent()
    {
        let str = `<br>`;
        for(let i=0; i<num_fuzzyRuleConsequents; ++i)
        {
            str += `FuzzyRuleAntecedent crt_antecedent${i+1}();<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_decFncs_createConsequent()
    {
        let str = `<br>`;
        for(let i=0; i<num_fuzzyRuleConsequents; ++i)
        {
            str += `FuzzyRuleConsequent crt_consequent${i+1}();<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzy()
    {
        let str = `<br>`;
        str += `Fuzzy fuzzy = Fuzzy();<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzySets_input1()
    {
        let str = `<br>`;
        for(let i=1; i<num_fuzzySets_input1-1; ++i)
        {
            let a = fuzzySets_input1[i-1];
            let b = fuzzySets_input1[i];
            let c = fuzzySets_input1[i];
            let d = fuzzySets_input1[i+1];
    
            str += `FuzzySet ${name_input1}_${i} = FuzzySet(${a.toFixed(2)}, ${b.toFixed(2)}, ${c.toFixed(2)}, ${d.toFixed(2)});<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzySets_input2()
    {
        let str = `<br>`;
        for(let i=1; i<num_fuzzySets_input2-1; ++i)
        {
            let a = fuzzySets_input2[i-1];
            let b = fuzzySets_input2[i];
            let c = fuzzySets_input2[i];
            let d = fuzzySets_input2[i+1];
    
            str += `FuzzySet ${name_input2}_${i} = FuzzySet(${a.toFixed(2)}, ${b.toFixed(2)}, ${c.toFixed(2)}, ${d.toFixed(2)});<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzySets_output()
    {
        let str = `<br>`;
        for(let i=1; i<num_fuzzySets_output-1; ++i)
        {
            let a = fuzzySets_output[i-1];
            let b = fuzzySets_output[i];
            let c = fuzzySets_output[i];
            let d = fuzzySets_output[i+1];
    
            str += `FuzzySet ${name_output}_${i} = FuzzySet(${a.toFixed(2)}, ${b.toFixed(2)}, ${c.toFixed(2)}, ${d.toFixed(2)});<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzyInput1()
    {
        let str = `<br>`;
        str += `FuzzyInput fuzzyInput1 = crt_fuzzyInput1();<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzyInput2()
    {
        let str = `<br>`;
        str += `FuzzyInput fuzzyInput2 = crt_fuzzyInput2();<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzyOutput()
    {
        let str = `<br>`;
        str += `FuzzyOutput fuzzyOutput = crt_fuzzyOutput();<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzyRuleAntecedents()
    {
        let str = `<br>`;
    
        for(let i=0; i<num_fuzzyRuleConsequents; ++i)
        {
            str += `FuzzyRuleAntecedent antecedent${i+1} = crt_antecedent${i+1}();<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzyRuleConsequents()
    {
        let str = `<br>`;
    
        for(let i=0; i<num_fuzzyRuleConsequents; ++i)
        {
            str += `FuzzyRuleConsequent consequent${i+1} = crt_consequent${i+1}();<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_fuzzyRules()
    {
        let str = `<br>`;
    
        for(let i=0; i<num_fuzzyRuleConsequents; ++i)
        {
            str += `FuzzyRule rule${i+1} = FuzzyRule(${i+1}, &antecedent${i+1}, &consequent${i+1});<br>`;
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_setup()
    {
        let str = `<br>`;
        
        str += `void setup()<br>`;
        str += `{<br>`;

        str += `  Serial.begin(115200);<br>`;
        str += `  randomSeed(analogRead(0));<br>`;
        str += `<br>`;

        str += `  fuzzy.addFuzzyInput  (&fuzzyInput1);<br>`;
        str += `  fuzzy.addFuzzyInput  (&fuzzyInput2);<br>`;
        str += `  fuzzy.addFuzzyOutput (&fuzzyOutput);<br>`;
    
        for(let i=0; i<num_fuzzyRuleConsequents; ++i){
            str += `  fuzzy.addFuzzyRule(&rule${i+1});<br>`;
        }
    
        str += `}<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_loop()
    {
        let str = `<br>`;
        
        str += `void loop()<br>`;
        str += `{<br>`;

        str += `<br>`;
        str += `  Serial.print("\n\n");<br>`;

        str += `<br>`;
        str += `  float input1 = random(${fuzzySets_input1[1]}, ${fuzzySets_input1[num_fuzzySets_input1-2]});<br>`;
        str += `  float input2 = random(${fuzzySets_input2[1]}, ${fuzzySets_input2[num_fuzzySets_input2-2]});<br>`;

        str += `<br>`;
        str += `Serial.printf("Input 1: %.2f\\n", input1);<br>`;
        str += `Serial.printf("Input 2: %.2f\\n", input2);<br>`;

        str += `<br>`;
        str += `  fuzzy.setInput(INDEX_FUZZY_INPUT1, input1);<br>`;
        str += `  fuzzy.setInput(INDEX_FUZZY_INPUT2, input2);<br>`;

        str += `<br>`;
        str += `  fuzzy.fuzzify();<br>`;

        str += `<br>`;
        str += `  float output = fuzzy.defuzzify(INDEX_FUZZY_OUTPUT);<br>`;
        str += `  Serial.printf("Ouput: %.2f\\n", output);<br>`;

        str += `<br>`;
        str += `  delay(12000);<br>`;

        str += `}<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_defFncs_createFuzzyInput()
    {
        let str = `<br>`;
        // Input 1
        // --------------------------------------
    
        str += `<br><br>`;
        str += `FuzzyInput crt_fuzzyInput1()<br>`;
        str += `{<br>`;
    
        str += `  FuzzyInput fuzzyInput = FuzzyInput(INDEX_FUZZY_INPUT1);<br>`;
    
        for(let i=0; i<num_fuzzySets_input1-2; ++i){
            str += `fuzzyInput.addFuzzySet(&${name_input1}_${i+1});<br>`;
        }
    
        str += `  return fuzzyInput;<br>`;
        str += `}<br>`;
    
        // Input 2
        // -------------------------------------
    
        str += `<br><br>`;
        str += `FuzzyInput crt_fuzzyInput2()<br>`;
        str += `{<br>`;
    
        str += `  FuzzyInput fuzzyInput = FuzzyInput(INDEX_FUZZY_INPUT2);<br>`;
    
        for(let i=0; i<num_fuzzySets_input2-2; ++i){
            str += `fuzzyInput.addFuzzySet(&${name_input2}_${i+1});<br>`;
        }
    
        str += `  return fuzzyInput;<br>`;
        str += `}<br>`;
    
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_defFncs_createFuzzyOutput()
    {
        let str = `<br>`;
        str += `<br><br>`;
        str += `FuzzyOutput crt_fuzzyOutput()<br>`;
        str += `{<br>`;
    
        str += `  FuzzyOutput fuzzyOutput = FuzzyOutput(INDEX_FUZZY_OUTPUT);<br>`;
    
        for(let i=0; i<num_fuzzySets_output-2; ++i){
            str += `fuzzyOutput.addFuzzySet(&${name_output}_${i+1});<br>`;
        }
    
        str += `  return fuzzyOutput;<br>`;
        str += `}<br>`;
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_defFncs_createAntecedent()
    {
        let str = `<br>`;
        let count = 1;
    
        for(let i=0; i<num_fuzzySets_input1-2; ++i){
            for(let j=0; j<num_fuzzySets_input2-2; ++j)
            {
                str += `<br><br>`;
                str += `FuzzyRuleAntecedent crt_antecedent${count}()<br>`;
                str += `{<br>`;
    
                str += `  FuzzyRuleAntecedent antecedent = FuzzyRuleAntecedent();<br>`;
                str += `  antecedent.joinWithAND(&${name_input1}_${i+1}, &${name_input2}_${j+1});<br>`;
                str += `<br>`;
    
                str += `  return antecedent;<br>`;
                str += `}<br>`;
    
                count += 1;
            }
        }
    
        document.body.innerHTML += str;
    }
    
    
    function print_code_defFncs_createConsequent()
    {
        let str = `<br>`;
        for(let i=0; i<num_fuzzyRuleConsequents; ++i)
        {
            str += `<br><br>`;
            str += `FuzzyRuleConsequent crt_consequent${i+1}()<br>`;
            str += `{<br>`;
    
            str += `  FuzzyRuleConsequent consequent = FuzzyRuleConsequent();<br>`;

            for(let j=1; j<num_fuzzySets_output-1; ++j){
                if(fuzzyRuleConsequents[i] == fuzzySets_output[j]){
                    str += `  consequent.addOutput(&${name_output}_${j});<br>`;
                    break;
                }
            }
            str += `<br>`;
    
            str += `  return consequent;<br>`;
            str += `}<br>`;
        }
    
        document.body.innerHTML += str;
    }
</script>

<body>
    <script>

    // print_line();
    print_code_library();

    print_line();
    print_code_macro();
    
    print_line();
    print_code_decFncs_createFuzzyInput();
    print_code_decFncs_createFuzzyOutput();
    print_code_decFncs_createAntecedent();
    print_code_decFncs_createConsequent();
    
    print_line();
    print_code_fuzzy();
    print_code_fuzzySets_input1();
    print_code_fuzzySets_input2();
    print_code_fuzzySets_output();
    print_code_fuzzyInput1();
    print_code_fuzzyInput2();
    print_code_fuzzyOutput();
    print_code_fuzzyRuleAntecedents();
    print_code_fuzzyRuleConsequents();
    print_code_fuzzyRules();

    print_line();
    print_code_setup();

    print_line();
    print_code_loop();

    print_line();
    print_code_defFncs_createFuzzyInput();
    print_code_defFncs_createFuzzyOutput();
    print_code_defFncs_createAntecedent();
    print_code_defFncs_createConsequent();

    </script>
</body>
</html>